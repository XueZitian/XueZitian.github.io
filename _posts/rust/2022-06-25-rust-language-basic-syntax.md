---
layout: post
title: RuståŸºæœ¬è¯­æ³•
category: rust
---

## 1 å˜é‡å’Œå¸¸é‡

### 1.1 å˜é‡çš„å£°æ˜
```rust
// by default variables are immutable
let x = 5;
// the way that make variables mutable
let mut x = 6;
```

### 1.2 å¸¸é‡çš„å£°æ˜
```rust
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;
```

### 1.3 å¸¸é‡ä¸å˜é‡çš„å¼‚åŒ
* åŒï¼šå¸¸é‡å’Œä¸å¯å˜å˜é‡éå¸¸ç±»ä¼¼ï¼Œåªå¯ä»¥åœ¨å®šä¹‰æ—¶ä¸ºå˜é‡ï¼ˆæˆ–å¸¸é‡ï¼‰èµ‹åˆå§‹å€¼ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸å¯ä»¥æ”¹å˜æ•°å€¼ï¼›
* å¼‚ï¼šå¸¸é‡åœ¨å®šä¹‰æ—¶ï¼Œå¿…é¡»å£°æ˜å¸¸é‡çš„ç±»å‹ï¼Œè€Œå˜é‡åˆ™å…è®¸æ ¹æ®æ‰€èµ‹äºˆçš„æ•°å­—ï¼Œæ¥æ¨æµ‹å‡ºå˜é‡çš„ç±»å‹ï¼›
* å¼‚ï¼šå¸¸é‡å¯ä»¥åœ¨ä»»ä½•èŒƒå›´å£°æ˜ï¼ŒåŒ…æ‹¬å…¨å±€èŒƒå›´ï¼›***å˜é‡å¯ä»¥åœ¨ä»€ä¹ˆèŒƒå›´å£°æ˜ï¼Ÿ***
* å¼‚ï¼šå¸¸é‡çš„åˆå§‹å€¼å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œä¸èƒ½æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶æ‰èƒ½ç¡®å®šæ•°å€¼çš„å˜é‡ï¼›
* å¼‚ï¼š***å¸¸é‡å’Œå˜é‡åœ¨å†…å­˜ä¸­å­˜åœ¨çš„å½¢å¼æ˜¯å¦æœ‰å·®åˆ«ï¼Œæ¯”å¦‚åœ¨ä¸åŒçš„æ®µï¼Ÿ***

### 1.4 å˜é‡çš„ä½œç”¨åŸŸ
æ¯ä¸ªå˜é‡éƒ½æœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œå¾€å¾€ä½œç”¨åŸŸå’Œå…¶ç”Ÿå‘½å‘¨æœŸæ˜¯ç›¸åŒçš„ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œå½“åœ¨ä¸€ä¸ªå˜é‡çš„å£°æ˜å‘¨æœŸå†…ï¼Œåˆå®šä¹‰ä¸€ä¸ªåŒåçš„å˜é‡ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå˜é‡çš„ä½œç”¨åŸŸä¼šå‘ç”Ÿå˜åŒ–ï¼Œå…¶ä¸­ä¸¤è€…ç”Ÿå‘½å‘¨æœŸé‡å çš„éƒ¨åˆ†ä¼šè¢«ç¬¬äºŒä¸ªå˜é‡å æœ‰ï¼Œå³è¿™éƒ¨åˆ†åŒºåŸŸç¬¬äºŒä¸ªå˜é‡çš„ä½œç”¨åŸŸç”Ÿæ•ˆã€‚

### 1.5 å˜é‡ç±»å‹çš„å£°æ˜
```rust
let x: u32 = 5;
```

## 2 æ•°æ®ç±»å‹
Rustä¸­çš„æ¯ä¸ªå€¼éƒ½æœ‰ç‰¹å®šçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥åˆ†ä¸ºï¼šæ ‡é‡å’Œå¤åˆç±»å‹ã€‚Rustæ˜¯ä¸€ä¸ªé™æ€ç±»å‹è¯­è¨€ï¼Œå³åœ¨ç¼–è¯‘é˜¶æ®µå®ƒå°±å¿…é¡»çŸ¥é“æ¯ä¸ªå˜é‡çš„ç±»å‹ã€‚ç¼–è¯‘å™¨å¯ä»¥åŸºäºèµ‹å€¼å’Œæˆ‘ä»¬çš„ç”¨æ³•æ¥æ¨ç†å˜é‡çš„ç±»å‹ï¼Œä½†æ˜¯å¦‚æœç¼–è¯‘å™¨æ— æ³•æ¨ç†å‡ºå˜é‡ç±»å‹ï¼Œå°±éœ€è¦æˆ‘ä»¬æ˜¾ç¤ºçš„å£°æ˜å˜é‡çš„ç±»å‹ã€‚

### 2.1 æ ‡é‡ç±»å‹(Scalar Types)
* æ•´å‹(integer): i/u8, i/u16, i/u32, i/u64, i/u128, **i/usize**(arch)ï¼Œé»˜è®¤ç±»å‹æ˜¯i32ã€‚debugæ¨¡å¼ï¼ŒRustä¼šåŒ…å«å¯¹æ•´å‹æ•°æº¢å‡ºçš„æ£€æŸ¥ï¼Œè€Œreleaseæ¨¡å¼åˆ™ä¸ä¼šã€‚å¦å¤–ï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºçš„å¤„ç†æº¢å‡ºæƒ…å†µï¼Œæ ‡å‡†åº“æä¾›äº†ä¸€äº›æ–¹æ³•ï¼šwrapping_\*, checked_\*, overflowing_\*, saturating_\*ã€‚

    | Number literals    | Example     |
    |-----------------   |-------------|
    | åè¿›åˆ¶(Decimal)     | 98_222      |
    | åå…­è¿›åˆ¶(Hex)       | 0xff        |
    | å…«è¿›åˆ¶(Octal)       | 0o77        |
    | äºŒè¿›åˆ¶(Binary)      | 0b1111_0000 |
    | å­—èŠ‚(Byte)(u8 only) | b'A'        |

* æµ®ç‚¹ç±»å‹(floating-point)ï¼šf32, f64ï¼Œé»˜è®¤ç±»å‹æ˜¯f64ã€‚
* å¸ƒå°”ç±»å‹(booleans)ï¼šboolï¼ŒåŒ…å«ä¸¤ä¸ªå€¼ï¼štrueå’Œfalseï¼Œå¤§å°æ˜¯ä¸€ä¸ªå­—èŠ‚ã€‚
* å­—ç¬¦ç±»å‹(characters)ï¼šcharï¼Œå¤§å°æ˜¯å››ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºUnicode Scalar Valueï¼Œä»U+0000åˆ°U+D7FFï¼Œä»U+E000åˆ°U+10FFFFã€‚
    ```rust
    fn main() {
        let c = 'z';
        let z: char = 'â„¤'; // with explicit type annotation
        let heart_eyed_cat = 'ğŸ˜»';
    }
    ```

### 2.2 ç®—æœ¯è¿ç®—
åŠ å‡ä¹˜é™¤ä»¥åŠæ±‚ä½™ï¼Œå…¶ä¸­æ•´æ•°é™¤æ³•ä¼šå‘ä¸‹èˆå…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ã€‚
```rust
fn main() {
    // addition
    let sum = 5 + 10;
    // subtraction
    let difference = 95.5 - 4.3;
    // multiplication
    let product = 4 * 30;
    // division
    let quotient = 56.7 / 32.2;
    let floored = 2 / 3; // Results in 0
    // remainder
    let remainder = 43 % 5;
}
```

### 2.3 å¤åˆç±»å‹
å¤åˆç±»å‹å¯ä»¥å°†å¤šä¸ªæ•°å€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ï¼Œrustæœ‰ä¸¤ä¸ªå¤åˆç±»å‹çš„åŸè¯­ï¼šå…ƒç»„(tuples)å’Œæ•°ç»„(arrays)

* å…ƒç»„ç±»å‹(tuples): å°†ä¸åŒç±»å‹çš„ä¸€ç»„æ•°ç»„åˆæˆä¸€ä¸ªå¤åˆç±»å‹ï¼Œå…ƒç»„ç±»å‹æœ‰å›ºå®šçš„é•¿åº¦ï¼Œä¸èƒ½åŠ¨æ€ä¼¸ç¼©ã€‚ä¸€ä¸ªä¸åŒ…å«ä»»åŠ¡æ•°æ®çš„å…ƒç»„ä¹Ÿç§°ä½œå•å…ƒ(unit)ã€‚å¦‚æœè¡¨è¾¾å¼ä¸è¿”å›ä»»ä½•å…¶å®ƒå€¼ï¼Œè¡¨è¾¾å¼ä¼šéšå¼çš„è¿”å›ä¸€ä¸ªunitç±»å‹ã€‚
    ```rust
    // create a tuple with type annotations
    let tup: (i32, f64, u8) = (500, 6.4, 1);
    // To get the individual values out of tuple by pattern matching
    let (x, y, z) = tup;
    // also access a tuple element directly by using a . followed by the index
    let first = tup.0;
    let third = tup.1;
    // unit type, how to use it?
    let unit: () = ();
    ```
* æ•°ç»„ç±»å‹(Array)ï¼šä¸åŒäºå…ƒç»„ï¼Œæ•°æ®ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¿…é¡»æ˜¯ç›¸åŒçš„ç±»å‹ï¼Œå¹¶ä¸”æ•°ç»„å¿…é¡»æ˜¯å›ºå®šé•¿åº¦ã€‚æ•°ç»„å­˜åœ¨äºæ ˆä¸­ï¼Œè€Œä¸æ˜¯å †ä¸­ã€‚å½“ä½¿ç”¨ä¸€ä¸ªå˜é‡ä½œä¸ºè®¿é—®æ•°ç»„çš„indexï¼Œå¦‚æœåœ¨è¿è¡Œæ—¶indexè¶…è¿‡äº†æ•°ç»„çš„æœ€å¤§é•¿åº¦ï¼Œç¨‹åºä¼šé€€å‡ºå¹¶æ‰“å°ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œå› æ­¤ï¼Œä¸åŒäºcè¯­è¨€ï¼ŒRustä¼šåœ¨è¿è¡Œæ—¶æ£€æŸ¥æ˜¯å¦å‘ç”Ÿäº†æ•°ç»„è¶Šç•Œï¼Œè¿™å°±æ˜¯ä½“ç°Rustå†…å­˜å®‰å…¨ç‰¹æ€§çš„ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚
    ```rust
    // define a array variable
    let a = [1, 2, 3, 4, 5];
    // add type and size annotations
    let a: [i32; 5] = [1, 2, 3, 4, 5];
    // init an array to contain the same value for each elem
    let a = [3; 5]; // equivalent to let a = [3, 3, 3, 3, 3];
    // accessing array elem
    let first = a[0];
    let second = a[1];
    ```

## 3 å‡½æ•°

å£°æ˜ä¸€ä¸ªæ–°çš„å‡½æ•°çš„å…³é”®å­—æ˜¯fnï¼ŒRustå‡½æ•°å’Œå˜é‡çš„å¸¸è§„é£æ ¼æ˜¯å­—æ¯å…¨æ˜¯å°å†™å¹¶ä½¿ç”¨ä¸‹åˆ’çº¿éš”ç¦»å•è¯ã€‚
```rust
fn main() {
    println!("Hello, World!");

    another_function();
}

fn another_function() {
    println!("Another function.");
}
```
å¯¹äºä¸Šé¢çš„ä»£ç ç‰‡æ®µï¼Œå¯ä»¥çœ‹åˆ°å‡½æ•°â€˜another_functionâ€™çš„å®šä¹‰åœ¨å¼•ç”¨ä¹‹åã€‚ä¸åŒäºcï¼ŒRustå¯¹è¢«å¼•ç”¨å‡½æ•°å®šä¹‰çš„ä½ç½®è¦æ±‚æ¯”è¾ƒå®½æ¾ï¼Œåªè¦æ˜¯åœ¨è°ƒç”¨è€…å¯ä»¥çœ‹åˆ°çš„èŒƒå›´å†…å³å¯ã€‚

### 3.1 å‡½æ•°å‚æ•°

å‡½æ•°å…è®¸å®šä¹‰å…¥å‚ï¼Œå®ƒæ˜¯å‡½æ•°ç­¾åçš„ä¸€éƒ¨åˆ†ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯å…¥å‚å¿…é¡»æ˜¾æ€§æŒ‡å®šå‚æ•°çš„ç±»å‹ã€‚å®šä¹‰å¤šä¸ªå…¥å‚æ—¶ï¼Œç”¨é€—å·åˆ†å‰²å¼€ã€‚
```rust
fn another_function(x: i32, unit_label: char) {
    println!("The value of x is: {x}{unit_label}");
}
```
### 3.2 é™ˆè¿°å’Œè¡¨è¾¾å¼

å‡½æ•°ä¸»ä½“ç”±ä¸€ç³»åˆ—çš„Statementså’Œå¯é€‰æ‹©çš„è¡¨è¾¾å¼ç»“å°¾ç»„æˆã€‚Rustæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼åŸºçš„è¯­è¨€ï¼Œé‚£ä¹ˆè¡¨è¾¾å¼å’Œé™ˆè¿°çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå…ˆæ¥çœ‹çœ‹ä¸¤è€…çš„å®šä¹‰ã€‚
* Statementsæ˜¯æ‰§è¡ŒæŸäº›æ“ä½œä¸”ä¸è¿”å›å€¼çš„æŒ‡ä»¤ã€‚ç”±äºé™ˆè¿°ä¸è¿”å›å€¼ï¼Œæ‰€ä»¥ä¸å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé™ˆè¿°ä¸ºå˜é‡èµ‹å€¼ã€‚
* Expressionsä¼šè®¡ç®—å‡ºä¸€ä¸ªç»“æœå€¼ï¼Œç»„æˆäº†Rustä»£ç çš„å¤§éƒ¨åˆ†ã€‚è¡¨è¾¾å¼ä¸åŒ…å«åˆ†å·ï¼Œä¸ºè¡¨è¾¾å¼æ·»åŠ åˆ†å·å°†åˆ°æ—¶è¡¨è¾¾å¼å˜ä¸ºé™ˆè¿°ï¼Œè¡¨è¾¾å¼å¯ä»¥ä½œä¸ºé™ˆè¿°çš„ä¸€éƒ¨åˆ†ã€‚
```rust
// Statements:
// 1. Creating a variable and assigning a value to it with the let keyword
let y = 6;
// 2. Function definitions
// Expressionsï¼š
// 1. ç®—æœ¯è¿ç®—ï¼Œæˆ–è€…ä¸€ä¸ªå¸¸æ•°
5 + 6
// 2. Calling a function
// 3. Calling a macro
// 4. ç”¨å¤§æ‹¬å·åˆ›å»ºçš„ä¸€ä¸ªä»£ç å—ï¼Œæ³¨æ„ï¼Œx + 1ä¸èƒ½æ·»åŠ åˆ†å·ï¼Œè¿™å°†å¯¼è‡´ä»£ç å—å˜æˆä¸€ä¸ªStatement
{
    let x = 3;
    x + 1
}
```

### 3.3 å‡½æ•°è¿”å›å€¼

Rustå‡½æ•°å¯ä»¥å®šä¹‰è¿”å›å€¼ï¼Œå¿…é¡»å£°æ˜è¿”å›å€¼çš„ç±»å‹ï¼Œä½†ä¸ç”¨ä¸ºè¿”å›å€¼å‘½åã€‚å‡½æ•°çš„è¿”å›å€¼æ˜¯å‡½æ•°ä¸»ä½“çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œä¹Ÿå¯ä»¥åœ¨å‡½æ•°ä¸»ä½“ä¸­é€šè¿‡returnå…³é”®å­—æå‰è¿”å›ã€‚
```rust
fn five -> i32 {
    5
}
```

## 4 æ§åˆ¶æµ

### 4.1 if

ifè¡¨è¾¾å¼å…è®¸æˆ‘ä»¬åŸºäºæ¡ä»¶è·³è½¬æˆ‘ä»¬çš„ä»£ç ã€‚Rustçš„ifè¯­æ³•å’Œcè¯­è¨€å¾ˆåƒï¼Œä½†æ˜¯åœ¨Rustä¸­ï¼Œæ•´æ•°ç±»å‹å˜é‡ä¸èƒ½ç›´æ¥ä½œä¸ºifçš„æ¡ä»¶ï¼Œå¿…é¡»ä½¿ç”¨boolç±»å‹ï¼ŒRustä¸ä¼šè‡ªåŠ¨å°†éå¸ƒå°”ç±»å‹çš„å˜é‡è½¬æ¢æˆå¸ƒå°”ç±»å‹ã€‚
```rust
fn main() {
    let number = 6;

    if number % 4 == 0 {
        println!("number is divisible by 4");
    } else if number % 3 == 0 {
        println!("number is divisible by 3");
    } else if number % 2 == 0 {
        println!("number is divisible by 2");
    } else {
        println!("number is not divisible by 4, 3, or 2");
    }
}
```

ifæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ‰€æœ‰æˆ‘ä»¬å¯ä»¥æ”¾å®ƒåœ¨leté™ˆè¿°çš„å³è¾¹ï¼Œå°†ifçš„ç»“æ„èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ã€‚
```rust
fn main() {
    let condition = true;
    let number = if condition { 5 } else { 6 };

    println!("The value of number is: {number}");
}
```

### 4.2 loop

loopå…³é”®å­—ä¼šæ— é™æ¬¡çš„æ‰§è¡Œä¸€ä¸ªä»£ç å—çš„å¾ªç¯ï¼Œç›´åˆ°ä½ æ˜¾æ€§çš„å»è®©ç¨‹åºåœæ­¢ï¼Œæ¯”å¦‚é”®å…¥Ctrl+cï¼Œæˆ–è€…åœ¨ä»£ç å—ä¸­æ’å…¥breakå…³é”®å­—ï¼Œå¦å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨ä»£ç å—ä¸­æ’å…¥continueå»è°ƒç”¨ä»£ç å—å‰©ä½™éƒ¨åˆ†ï¼Œç„¶åå¼€å§‹ä¸‹ä¸€æ¬¡çš„å¾ªç¯ã€‚
```rust
fn main() {
    loop {
        println!("again!");
    }
}
```

**loopçš„è¿”å›å€¼**

loopçš„ä¸€ç§ç”¨æ³•æ˜¯ï¼Œå°è¯•ä¸€ä¸ªå¯èƒ½å¤±è´¥çš„æ“ä½œï¼Œç„¶ååœ¨è·³å‡ºloopçš„æ—¶å€™ï¼Œä½ å¸Œæœ›è·å–loopæ“ä½œçš„ç»“æœï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨breakï¼Œå¹¶åœ¨breakåè¾¹åŠ ä¸€ä¸ªè¡¨è¾¾å¼ã€‚
```rust
fn main() {
    let mut counter = 0;

    let result = loop {
        counter += 1;

        if counter == 10 {
            break counter * 2;
        }
    };

    println!("The result is {result}");
}
```

**loopæ ‡ç­¾**

å½“ä½¿ç”¨å¤šä¸ªloopåµŒå¥—çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨breakæˆ–è€…continueåŠ æ ‡ç­¾ç›´æ¥ä»é‡Œé¢çš„loopè·³åˆ°å¤–å±‚çš„loopã€‚å¦‚ï¼Œä¸‹é¢çš„æ ‡ç­¾ï¼š'counting_up
```rust
fn main() {
    let mut count = 0;
    'counting_up: loop {
        println!("count = {count}");
        let mut remaining = 10;

        loop {
            println!("remaining = {remaining}");
            if remaining == 9 {
                break;
            }
            if count == 2 {
                break 'counting_up;
            }
            remaining -= 1;
        }

        count += 1;
    }
    println!("End count = {count}");
}
```

### 4.3 while

whileå¾ªç¯çš„å¦‚æ³•å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut number = 3;

    while number != 0 {
        println!("{number}!");

        number -= 1;
    }

    println!("LIFTOFF!!!");
}
```

### 4.4 for

Rustä¸­çš„forå¾ªç¯ä¸cè¯­è¨€æœ‰å¾ˆå¤§å·®åˆ«ï¼ŒRustä»å®‰å…¨æ€§å’Œæ˜“ç”¨æ€§è§’åº¦å‡ºå‘ï¼Œä½¿å¾—forå¾ªç¯éå¸¸é€‚åˆç”¨åœ¨éå†æŸä¸ªé›†åˆ(å¦‚ï¼Œæ•°ç»„)ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ çš„åœºæ™¯ã€‚
```rust
fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a {
        println!("the value is: {element}");
    }
}
```
ä¸Šé¢åŸºäºforå¾ªç¯å¯¹æ•°ç»„éå†ï¼Œä¸ç”¨æ‹…å¿ƒå‘ç”Ÿæ•°ç»„è®¿é—®è¶Šç•Œçš„é—®é¢˜ï¼Œè¯­æ³•ä¹Ÿéå¸¸ç²¾ç‚¼ã€‚

å¦å¤–ï¼Œå¯ä»¥å¯ä»¥å€ŸåŠ©æ ‡å‡†åº“æä¾›çš„Rangeï¼Œæ¥äº§ç”Ÿä¸€ä¸ªæ•°å­—åºåˆ—ä¾›forå¾ªç¯ä½¿ç”¨ï¼Œç”šè‡³å¯ä»¥è°ƒç”¨revæ–¹æ³•æ¥åè½¬æ•°å­—åºåˆ—ã€‚
```rust
fn main() {
    for number in (1..4).rev() {
        println!("{number}!");
    }
    println!("LIFTOFF!!!");
}
// output:
// 3!
// 2!
// 1!
// LIFTOFF!!!
```

# Reference
1. [The Rust Programming Language][1]

[1]: https://doc.rust-lang.org/book/